<!--
  ~ Copyright (C) 2011, FuseSource Corp.  All rights reserved.
  ~ http://fusesource.com
  ~
  ~ The software in this package is published under the terms of the
  ~ CDDL license a copy of which has been included with this distribution
  ~ in the license.txt file.
  -->

<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">

    <command-bundle xmlns="http://karaf.apache.org/xmlns/shell/v1.0.0">
        <command name="virt/domain-list">
            <action class="org.fusesource.fabric.virt.commands.ListDomains">
                <property name="connections" ref="connections"/>
            </action>
        </command>
        <command name="virt/domain-define">
            <action class="org.fusesource.fabric.virt.commands.DefineDomain">
                <property name="connections" ref="connections"/>
            </action>
        </command>
        <command name="virt/domain-start">
            <action class="org.fusesource.fabric.virt.commands.StartDomain">
                <property name="connections" ref="connections"/>
            </action>
            <completers>
                <ref component-id="inactiveDomainNameCompleter"/>
            </completers>
        </command>
        <command name="virt/domain-stop">
            <action class="org.fusesource.fabric.virt.commands.StopDomain">
                <property name="connections" ref="connections"/>
            </action>
            <completers>
                <ref component-id="activeDomainNameCompleter"/>
            </completers>
        </command>
    </command-bundle>

    <bean id="inactiveDomainNameCompleter" class="org.fusesource.fabric.virt.commands.completer.InactiveDomainNameCompleter">
        <property name="connections" ref="connections"/>
    </bean>

    <bean id="activeDomainNameCompleter" class="org.fusesource.fabric.virt.commands.completer.ActiveDomainNameCompleter">
        <property name="connections" ref="connections"/>
    </bean>

    <reference-list id="connections" interface="org.libvirt.Connect" availability="optional"/>

</blueprint>