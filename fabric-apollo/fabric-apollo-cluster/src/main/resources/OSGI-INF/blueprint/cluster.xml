<?xml version="1.0" encoding="UTF-8"?>
<!--

    Copyright (C) 2010-2011, FuseSource Corp.  All rights reserved.

        http://fusesource.com

    The software in this package is published under the terms of the
    CDDL license a copy of which has been included with this distribution
    in the license.txt file.

-->

<blueprint
  xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
  xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.0.0"
  xmlns:ext="http://aries.apache.org/blueprint/xmlns/blueprint-ext/v1.0.0">

  <cm:property-placeholder persistent-id="org.apache.activemq.apollo">
  <!-- <cm:property-placeholder persistent-id="org.apache.activemq.apollo" update-strategy="reload"> -->
    <cm:default-properties>
      <cm:property name="apollo.base" value="."/>
      <cm:property name="zk.base" value="/apollo"/>
      <cm:property name="node" value="default"/>
    </cm:default-properties>
  </cm:property-placeholder>


  <bean id="cluster-broker" class="org.fusesource.fusemq.cluster.OsgiClusterBrokerService"
        init-method="start" destroy-method="stop">
    <property name="context" ref="blueprintBundleContext"/>
    <property name="basedir" value="${apollo.base}"/>

    <property name="configAdmin">
      <reference interface="org.osgi.service.cm.ConfigurationAdmin"/>
    </property>
    <property name="zooKeeper">
        <reference interface="org.linkedin.zookeeper.client.IZKClient"/>
    </property>
    <property name="zkBase" value="${zk.base}"/>
    <property name="node" value="${node}"/>
  </bean>

</blueprint>