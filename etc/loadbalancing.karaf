fabric:create-profile --parents camel camel-cluster
fabric:edit-profile -p camel-cluster --repositories mvn:org.fusesource.fabric.fabric-examples.fabric-camel-cluster/features/${project.version}/xml/features
fabric:edit-profile -p camel-cluster --features fusesource-fabric-camel

fabric:create-profile --parents camel-cluster camel-client
fabric:edit-profile -p camel-client --features camel-client

fabric:create-profile --parents camel-cluster camel-server
fabric:edit-profile -p camel-server --features camel-server

fabric:create-profile --parents camel-server server-9090
fabric:edit-profile -p server-9090 --pid fabricCamel portNumber=9090

fabric:create-profile --parents camel-server server-9191
fabric:edit-profile -p server-9191 --pid fabricCamel portNumber=9191

shell:echo Creating agents

shell:echo 1. Create client node
fabric:create-agent --profile camel-client --parent $APPLICATION camel-client
shell:echo Wait 10s.. be patient
shell:sleep 10000

shell:echo 2. Create server node listening on port 9090
fabric:create-agent --profile server-9090 --parent $APPLICATION server-9090
shell:echo Wait 10s.. be patient
shell:sleep 10000

shell:echo 3. Create server node listening on port 9191
fabric:create-agent --profile server-9191 --parent $APPLICATION server-9191
shell:echo Wait 10s.. be patient
shell:sleep 10000

shell:echo done.
