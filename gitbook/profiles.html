<!DOCTYPE HTML>
<html lang="en-US" manifest="./manifest.appcache">
    
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        
        <meta charset="UTF-8">
        <title>Profiles | Fabric8 Documentation</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="https:">
        <meta name="description" content="Fabric8 User Guide and Reference Documentation">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="./agent.html" />
        
        
        <link rel="prev" href="./registry.html" />
        

        <meta property="og:title" content="Profiles | Fabric8 Documentation">
        <meta property="og:site_name" content="Fabric8 Documentation">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/https:">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
        
    </head>
    <body>
        
        

        <link rel="stylesheet" href="gitbook/style.css">
        


        
    <div class="book" data-github="https://github.com/fabric8io/fabric8" data-level="3.2" data-basepath="." data-revision="1402335640899">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="http://fabric8.io/" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/https://github.com/fabric8io/fabric8/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/https://github.com/fabric8io/fabric8/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="./" >Fabric8 Documentation</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/fabric8io/fabric8/blob/master/readme.md" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/fabric8io/fabric8/issues?milestone=none&amp;state=closed" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/fabric8io/fabric8/blob/master/Contributing.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="./"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="overview.html">
            
            <a href="./overview.html">
                <i class="fa fa-check"></i> <b>1.</b> Introduction
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="overview.html">
            
            <a href="./overview.html">
                <i class="fa fa-check"></i> <b>1.1.</b> Overview
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="getStarted.html">
            
            <a href="./getStarted.html">
                <i class="fa fa-check"></i> <b>1.2.</b> Get Started
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="quickstarts.html">
            
            <a href="./quickstarts.html">
                <i class="fa fa-check"></i> <b>1.3.</b> QuickStarts
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="environmentVariables.html">
            
            <a href="./environmentVariables.html">
                <i class="fa fa-check"></i> <b>1.4.</b> Environment Variables
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="developer.html">
            
            <a href="./developer.html">
                <i class="fa fa-check"></i> <b>2.</b> Developing
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="developer.html">
            
            <a href="./developer.html">
                <i class="fa fa-check"></i> <b>2.1.</b> Developer Workflow
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="mavenPlugin.html">
            
            <a href="./mavenPlugin.html">
                <i class="fa fa-check"></i> <b>2.2.</b> Maven Plugin
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="registry.html">
            
            <a href="./registry.html">
                <i class="fa fa-check"></i> <b>3.</b> Architecture
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="registry.html">
            
            <a href="./registry.html">
                <i class="fa fa-check"></i> <b>3.1.</b> Registry
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="profiles.html">
            
            <a href="./profiles.html">
                <i class="fa fa-check"></i> <b>3.2.</b> Profiles
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="agent.html">
            
            <a href="./agent.html">
                <i class="fa fa-check"></i> <b>3.3.</b> Agent
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="git.html">
            
            <a href="./git.html">
                <i class="fa fa-check"></i> <b>3.4.</b> Git
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="mavenProxy.html">
            
            <a href="./mavenProxy.html">
                <i class="fa fa-check"></i> <b>3.5.</b> Maven Proxy
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="microServices.html">
            
            <a href="./microServices.html">
                <i class="fa fa-check"></i> <b>4.</b> Containers
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="microServices.html">
            
            <a href="./microServices.html">
                <i class="fa fa-check"></i> <b>4.1.</b> Micro Services
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="javaContainer.html">
            
            <a href="./javaContainer.html">
                <i class="fa fa-check"></i> <b>4.2.</b> Java Container
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="springBootContainer.html">
            
            <a href="./springBootContainer.html">
                <i class="fa fa-check"></i> <b>4.3.</b> Spring Boot Container
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="docker.html">
            
            <a href="./docker.html">
                <i class="fa fa-check"></i> <b>4.4.</b> Docker
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="sshContainers.html">
            
            <a href="./sshContainers.html">
                <i class="fa fa-check"></i> <b>4.5.</b> SSH Containers
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="cloudContainers.html">
            
            <a href="./cloudContainers.html">
                <i class="fa fa-check"></i> <b>4.6.</b> Cloud Containers
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="gateway.html">
            
            <a href="./gateway.html">
                <i class="fa fa-check"></i> <b>5.</b> Additional Features
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="gateway.html">
            
            <a href="./gateway.html">
                <i class="fa fa-check"></i> <b>5.1.</b> Gateway
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="requirements.html">
            
            <a href="./requirements.html">
                <i class="fa fa-check"></i> <b>5.2.</b> Requirements
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="rollingUpgrade.html">
            
            <a href="./rollingUpgrade.html">
                <i class="fa fa-check"></i> <b>5.3.</b> Rolling Upgrade
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="offlineRepo.html">
            
            <a href="./offlineRepo.html">
                <i class="fa fa-check"></i> <b>5.4.</b> Offline Repository
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="partition.html">
            
            <a href="./partition.html">
                <i class="fa fa-check"></i> <b>5.5.</b> Partition
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="processManager.html">
            
            <a href="./processManager.html">
                <i class="fa fa-check"></i> <b>5.6.</b> Process Manager
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="security.html">
            
            <a href="./security.html">
                <i class="fa fa-check"></i> <b>5.7.</b> Security
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="propertyResolver.html">
            
            <a href="./propertyResolver.html">
                <i class="fa fa-check"></i> <b>5.8.</b> Property Resolver
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="urlHandlers.html">
            
            <a href="./urlHandlers.html">
                <i class="fa fa-check"></i> <b>5.9.</b> URL Handlers
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="brokerTopology.html">
            
            <a href="./brokerTopology.html">
                <i class="fa fa-check"></i> <b>6.</b> Using Apache ActiveMQ
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="brokerTopology.html">
            
            <a href="./brokerTopology.html">
                <i class="fa fa-check"></i> <b>6.1.</b> Broker Topology
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="brokerClients.html">
            
            <a href="./brokerClients.html">
                <i class="fa fa-check"></i> <b>6.2.</b> Broker Clients
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="dataTransform.html">
            
            <a href="./dataTransform.html">
                <i class="fa fa-check"></i> <b>7.</b> Using Apache Camel
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="dataTransform.html">
            
            <a href="./dataTransform.html">
                <i class="fa fa-check"></i> <b>7.1.</b> Data Transform
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" >
            
            <span><b>7.2.</b> Endpoints</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.2.1" data-path="camelEndpointAmq.html">
            
            <a href="./camelEndpointAmq.html">
                <i class="fa fa-check"></i> <b>7.2.1.</b> amq
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2.2" data-path="camelEndpointFabric.html">
            
            <a href="./camelEndpointFabric.html">
                <i class="fa fa-check"></i> <b>7.2.2.</b> fabric
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2.3" data-path="camelEndpointMaster.html">
            
            <a href="./camelEndpointMaster.html">
                <i class="fa fa-check"></i> <b>7.2.3.</b> master
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="cxfFabric.html">
            
            <a href="./cxfFabric.html">
                <i class="fa fa-check"></i> <b>8.</b> Using Apache CXF
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="cxfFabric.html">
            
            <a href="./cxfFabric.html">
                <i class="fa fa-check"></i> <b>8.1.</b> CXF Fabric
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 24.242424242424242%;min-width: 21.21212121212121%;"></div>
    </div>
    <div class="chapters">
    
        <a href="./index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="./overview.html" title="Overview" class="chapter done " data-progress="1.1" style="left: 3.0303030303030303%;"></a>
    
        <a href="./getStarted.html" title="Get Started" class="chapter done " data-progress="1.2" style="left: 6.0606060606060606%;"></a>
    
        <a href="./quickstarts.html" title="QuickStarts" class="chapter done " data-progress="1.3" style="left: 9.090909090909092%;"></a>
    
        <a href="./environmentVariables.html" title="Environment Variables" class="chapter done " data-progress="1.4" style="left: 12.121212121212121%;"></a>
    
        <a href="./developer.html" title="Developer Workflow" class="chapter done " data-progress="2.1" style="left: 15.151515151515152%;"></a>
    
        <a href="./mavenPlugin.html" title="Maven Plugin" class="chapter done " data-progress="2.2" style="left: 18.181818181818183%;"></a>
    
        <a href="./registry.html" title="Registry" class="chapter done " data-progress="3.1" style="left: 21.21212121212121%;"></a>
    
        <a href="./profiles.html" title="Profiles" class="chapter done " data-progress="3.2" style="left: 24.242424242424242%;"></a>
    
        <a href="./agent.html" title="Agent" class="chapter  " data-progress="3.3" style="left: 27.272727272727273%;"></a>
    
        <a href="./git.html" title="Git" class="chapter  " data-progress="3.4" style="left: 30.303030303030305%;"></a>
    
        <a href="./mavenProxy.html" title="Maven Proxy" class="chapter  " data-progress="3.5" style="left: 33.333333333333336%;"></a>
    
        <a href="./microServices.html" title="Micro Services" class="chapter  " data-progress="4.1" style="left: 36.36363636363637%;"></a>
    
        <a href="./javaContainer.html" title="Java Container" class="chapter  " data-progress="4.2" style="left: 39.39393939393939%;"></a>
    
        <a href="./springBootContainer.html" title="Spring Boot Container" class="chapter  " data-progress="4.3" style="left: 42.42424242424242%;"></a>
    
        <a href="./docker.html" title="Docker" class="chapter  " data-progress="4.4" style="left: 45.45454545454545%;"></a>
    
        <a href="./sshContainers.html" title="SSH Containers" class="chapter  " data-progress="4.5" style="left: 48.484848484848484%;"></a>
    
        <a href="./cloudContainers.html" title="Cloud Containers" class="chapter  " data-progress="4.6" style="left: 51.515151515151516%;"></a>
    
        <a href="./gateway.html" title="Gateway" class="chapter  " data-progress="5.1" style="left: 54.54545454545455%;"></a>
    
        <a href="./requirements.html" title="Requirements" class="chapter  " data-progress="5.2" style="left: 57.57575757575758%;"></a>
    
        <a href="./rollingUpgrade.html" title="Rolling Upgrade" class="chapter  " data-progress="5.3" style="left: 60.60606060606061%;"></a>
    
        <a href="./offlineRepo.html" title="Offline Repository" class="chapter  " data-progress="5.4" style="left: 63.63636363636363%;"></a>
    
        <a href="./partition.html" title="Partition" class="chapter  " data-progress="5.5" style="left: 66.66666666666667%;"></a>
    
        <a href="./processManager.html" title="Process Manager" class="chapter  " data-progress="5.6" style="left: 69.6969696969697%;"></a>
    
        <a href="./security.html" title="Security" class="chapter  " data-progress="5.7" style="left: 72.72727272727273%;"></a>
    
        <a href="./propertyResolver.html" title="Property Resolver" class="chapter  " data-progress="5.8" style="left: 75.75757575757575%;"></a>
    
        <a href="./urlHandlers.html" title="URL Handlers" class="chapter  " data-progress="5.9" style="left: 78.78787878787878%;"></a>
    
        <a href="./brokerTopology.html" title="Broker Topology" class="chapter  " data-progress="6.1" style="left: 81.81818181818181%;"></a>
    
        <a href="./brokerClients.html" title="Broker Clients" class="chapter  " data-progress="6.2" style="left: 84.84848484848484%;"></a>
    
        <a href="./dataTransform.html" title="Data Transform" class="chapter  " data-progress="7.1" style="left: 87.87878787878788%;"></a>
    
        <a href="./camelEndpointAmq.html" title="amq" class="chapter  " data-progress="7.2.1" style="left: 90.9090909090909%;"></a>
    
        <a href="./camelEndpointFabric.html" title="fabric" class="chapter  " data-progress="7.2.2" style="left: 93.93939393939394%;"></a>
    
        <a href="./camelEndpointMaster.html" title="master" class="chapter  " data-progress="7.2.3" style="left: 96.96969696969697%;"></a>
    
        <a href="./cxfFabric.html" title="CXF Fabric" class="chapter  " data-progress="8.1" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_25">
                    
                        <h2 id="profiles">Profiles</h2>
<p>A profile is a description of how a logical group of containers needs to be provisioned. It contains a list of:</p>
<ul>
<li>System properties</li>
<li>OSGi Configuration Admin PIDs</li>
<li>Maven artifact repositories</li>
<li>Bundles</li>
<li>Karaf feature repositories</li>
<li>Features</li>
</ul>
<p>and also defines the OSGi framework that is going to be used.</p>
<p>Each profile can have none, one or more parents, and this allows allows you to have profile hierarchies and a container can be assigned one or more profiles.
Profiles are also version, which allows you to keep different versions of each profile and then upgrade or rollback containers by changing the version of the profiles they use.</p>
<h3 id="profile-hierarchies">Profile hierarchies</h3>
<p>It is quite often that multiple profiles share similar bits of configuration. Its quite common different application to use common frameworks libraries etc. Defining everything from group up for each profile can be a real pain and is not that easy to maintain.
To avoid having duplicate configuration across profiles and reduce the required maintenance, Fabric uses a hierarchical model for profiles, which allows you to build a generic profile which contains common configuration and then inherit the common bits.</p>
<p>The section below describes the profiles that are shipped with Fabric out of the box and are a good example of how profile hierarchies work.</p>
<h3 id="out-of-the-box-profiles">Out of the box profiles</h3>
<p>Fabric provides a rich set of profiles *&quot;out of the box&quot; that can be used as the basic building blocks for definining your own profiles. The most important profiles are:</p>
<ul>
<li><strong>default</strong> The default profile defines the all the basic stuff that fabric needs to run. For example it defines the <em>fabric-agent</em> feature, the fabric registry url &amp; the list of maven repositories that can be used to download artifacts from.</li>
<li><strong>karaf</strong> It is a child of <strong>default</strong> (so it doesn&#39;t need to define the same things again. It also defines the karaf feature repositories, that can be used for defining any karaf feature.</li>
<li><strong>camel</strong> It is a child of <strong>karaf</strong>. It also defines the camel feature repositories and some core camel features such as <em>camel-core</em> &amp; <em>camel-blueprint</em>. Any profile for describing camel application is suggested to inherit this one.</li>
<li><strong>cxf</strong> It is a child of <strong>karaf</strong>. It also defines the cxf feature repositories and some core cxf features. It is intended to be the parent of any profile that describes a cxf application.</li>
<li><strong>mq-base</strong> A profile that inherit the <strong>karaf</strong> profile and defines the  <em>mq-fabric</em> feature</li>
<li><strong>mq</strong> It is a child of the <strong>mq-base</strong> profile and it also provides a fuse mq broker configuration.</li>
<li><strong>esb</strong> It is a child of <strong>camel</strong>,<strong>mq</strong> &amp; more profiles and also defines the <em>Fuse ESB</em> feature repository.</li>
</ul>
<h3 id="changing-the-profile-of-a-container">Changing the profile of a container</h3>
<p>At any give time you are able to change on of more of the profiles that are assigned to a container. You can use the <a href="commands/fabric-container-change-profile.html">fabric:container-change-profile</a> command as shown below:</p>
<pre><code>  fabric:container-change-profile mycontainer myprofile
</code></pre><p>The command above will assign the <strong>myprofile</strong> profile to <strong>mycontainer</strong>. All profiles previously assigned to the container will be removed. You can also specify multiple profiles to the container:</p>
<pre><code>   fabric:container-change-profile mycontainer myprofile myotherprofile
</code></pre><h3 id="creating-and-editing-profiles">Creating and editing profiles</h3>
<p>To see the list of available profiles you can use the <strong>fabric:profile-list</strong>:</p>
<pre><code>    fabric:profile-list
</code></pre><p>The command will display all the profiles and also display their parents and the number of containers that currently make use of each profile:</p>
<pre><code>    [id]                                     [# containers] [parents]
    activemq-client                          0              default
    aws-ec2                                  0              cloud
    camel                                    0              karaf
    camel-jms                                0              camel, activemq-client
    cloud                                    0              karaf
    cloudservers-uk                          0              cloud
    cloudservers-us                          0              cloud
    cxf                                      0              karaf
    default                                  0
    dosgi                                    0              karaf
    example-camel                            0              karaf
    example-cxf                              0              cxf
    example-mq                               0              example-mq-base
    example-mq-base                          0              karaf
    example-mq-cluster                       0              example-mq-base
    fabric                                   1              karaf
    fmc                                      0              default
    hadoop                                   0              karaf
    hadoop-datanode                          0              hadoop
    hadoop-namenode                          0              hadoop
    hawtio                                   0              default
    insight                                  0              default
    insight-hdfs                             0              insight
    karaf                                    0              default
    mq                                       0              mq-base
    mq-base                                  0              karaf
    nmr                                      0              karaf
</code></pre><p>To see exactly what a profile defines you can use the <strong>fabric:profile-display</strong> command. For example let&#39;s take a look of what is defined in the camel profile.</p>
<pre><code>    fabric:profile-display camel
</code></pre><p>This command will display all information available for the camel profile:</p>
<pre><code>    Profile id: camel
    Version   : 1.0
    Parents   : karaf
    Associated Containers :

    Container settings
    ----------------------------
    Repositories :
        mvn:org.apache.camel.karaf/apache-camel/2.13.0/xml/features

    Features :
        camel-blueprint/2.13.0
        fabric-camel/1.1.0
        camel-core/2.13.0
</code></pre><p>Of course this command does not display what is inherited from the parents of the profile <em>(in this example the karaf profile)</em>. To unfold the profile hierarchy and also see the inherited configuration you can use the <strong>--overlay</strong> option:</p>
<pre><code>    fabric:profile-display --overlay camel
</code></pre><h4 id="creating-a-new-profile">Creating a new profile</h4>
<p>In order to create a new profile that will describe how your application should be provisioned, you can use the <a href="commands/fabric-profile-create.html">fabric:profile-create</a> command.</p>
<pre><code>    fabric:profile-create myprofile
</code></pre><p>To specify one ore more parents to the profile you can use the <strong>--parents</strong> option:</p>
<pre><code>    fabric:profile-create --parents camel myprofile
</code></pre><p>As soon as the profile is created you can modify the profile, using the commands that are described in the following sections of the document.</p>
<h4 id="adding-or-removing-a-feature-to-a-profile">Adding or removing a feature to a profile</h4>
<p>In order to edit one of the existing profile you can use the <a href="commands/fabric-profile-edit.html">fabric:profile-edit</a> command.</p>
<p>In this example I will use the command to add the <em>camel-jclouds</em> feature to the <strong>camel</strong> profile.</p>
<pre><code>    fabric:profile-edit --features camel-jclouds camel
</code></pre><p>After the command I can display again the profile and see how the camel profile looks like now. You should now be able to see the <em>camel-jclouds</em> feature in the list of features of the <strong>camel</strong> profile.</p>
<pre><code>    Features :
        camel-jclouds
        camel-blueprint/2.13.0
        camel-core/2.13.0
        fabric-camel/1.1.0
</code></pre><p>If you want to remove a feature from the profile you can make use of the <strong>--delete</strong> option. So, if gor example you need to remove the <em>camel-jclouds</em> feature:</p>
<pre><code>    fabric:profile-edit --delete --features camel-jclouds camel
</code></pre><h4 id="modifying-a-configuration-pid-in-a-profile">Modifying a configuration pid in a profile</h4>
<p>A more complex example is when you need to modify the a configuration pid of a profile. A configuration pid is actually a list of key value pairs. So to edit or add a new key value pair to a specific pid you can use the <strong>-pid</strong> and specify the pid and key value in the following format <em>pid/key=value</em>.
In the following example, I will modify the <em>io.fabric8.agent</em> pid and change the maven repository list. The default profile should contain a section like this:</p>
<pre><code>    Agent Properties :
          org.ops4j.pax.url.mvn.repositories= \
            http://repo1.maven.org/maven2@id=central, \
            https://repo.fusesource.com/nexus/content/groups/public@id=fusepublic, \
            https://repository.jboss.org/nexus/content/repositories/public@id=jbosspublic, \
            https://repo.fusesource.com/nexus/content/repositories/releases@id=jbossreleases, \
            https://repo.fusesource.com/nexus/content/groups/ea@id=jbossearlyaccess, \
            http://repository.springsource.com/maven/bundles/release@id=ebrreleases, \
            http://repository.springsource.com/maven/bundles/external@id=ebrexternal, \
            https://oss.sonatype.org/content/groups/scala-tools@id=scala
</code></pre><p>Let&#39;s see how we can change the Agent Properties section <em>(the agent properties is represented by the io.fabric8.agent pid that was mentioned above)</em>:</p>
<pre><code>             fabric:profile-edit --pid io.fabric8.agent/org.ops4j.pax.url.mvn.repositories=http://repositorymanager.mylocalnetwork.net default
</code></pre><p>Now the <a href="commands/fabric-profile-edit.html">fabric:profile-edit</a> command for the <strong>default</strong> profile should be similar to:</p>
<pre><code>             Agent Properties :
                   org.ops4j.pax.url.mvn.repositories = http://repositorymanager.mylocalnetwork.net
</code></pre><h3 id="profile-editor">Profile Editor</h3>
<p>The profile edit command is quite flexible, however in some cases, you would really prefer a more traditional way of editing. Mainly becasue:</p>
<ul>
<li>You want to perform many changes at once</li>
<li>It feels more natural</li>
</ul>
<p>This is why fabric provides a profile editor embedded to your shell. You can use it, like:</p>
<pre><code>  fabric:profile-edit default (with no options)
</code></pre><p><img src="/images/fabric/profile-edit.png" alt="Opening the profile inside the editor"></p>
<p>The editor supports the basic editor functionality like undo, redo, forward/backward search, highlighting etc. What you are actually editing is the content of the io.fabric8.agent pid.
But you can use it to also edit any other pid or resource in your profile. For example to edit the io.fabric8.maven pid of the fabric profile, you can simply:</p>
<pre><code>  fabric:profile-edit --pid io.fabric8.maven fabric
</code></pre><p><img src="/images/fabric/profile-edit-pid.png" alt="Editing a pid"></p>
<p>A pretty similar approach applies to any resouce under the profile. For example, to edit the broker.xml of the mq-base profile:</p>
<pre><code>  fabric:profile-edit --resource broker.xml mq-base
</code></pre><p><img src="/images/fabric/profile-edit-resource.png" alt="Editing a pid"></p>
<h3 id="profile-versions">Profile versions</h3>
<p>Every profile has at least one version. When assigning a profile to a container, you actually assign both the profile and the version. The <a href="fabric-agent.html">fabric-agent</a>, will choose the defined version and retrieve all the information provided by the specific version of the profile.</p>
<p>Any change to a profile, will take immediate effect. This means that if there are containers that are assigned the version of a profile that was just modify will pick up the change immediately.
So it is recommended, to create a new version of a profile whenever you need to make changes and then assign the new version to the container. This allows you to complete your changes, test them and rollback to the previous version if you encounter issues.</p>
<h4 id="create-a-new-version">Create a new version</h4>
<p>You are able to create a new version using the <a href="commands/fabric-version-create.html">fabric:version-create</a>. The default version is 1.0 so let&#39;s create 1.1.</p>
<pre><code>    fabric:version-create 1.1
</code></pre><p>Once the version has been created an instance of each profile has been created for the new version. To be more precise a copy of the latest version of each profile has been added to the new version.
Now you can display or modify the 1.1 version of each profile. Let&#39;s display the <strong>camel</strong> profile:</p>
<pre><code>    fabric:profile-display --version 1.1 camel
</code></pre><p>The output will be identical to the 1.0 version of the profile, since we haven&#39;t applied any change to the profile yet.</p>
<p>But how do we modify a specific version of profile?</p>
<p>All you need to do is to specify the version right after the profile argument. For example let&#39;s add the <em>camel-jclouds</em> component to version 1.1 of the <strong>camel</strong> profile:</p>
<pre><code>    fabric:profile-edit --features camel-jclouds camel 1.1
</code></pre><p>Please note, that this will not affect any of your existing container, not until you upgrade them to the 1.1 version.</p>
<h4 id="rolling-upgrades-rollbacks">Rolling upgrades &amp; rollbacks</h4>
<p>Fabric provides commands for upgrading <em>(increasing the version)</em> and rolling back <em>(decreasing the version)</em> of the profiles assigned to a container. In order to upgrade a single container to the 1.1 version that we created in the previous section you can use the <a href="commands/fabric-container-upgrade.html">fabric:container-upgrade</a>. For example:</p>
<pre><code>    fabric:container-upgrade 1.1 mycontainer
</code></pre><p>The command above will make make <em>mycontainer</em> to use the version 1.1 of all the profiles that have been currently assigned to it.</p>
<p>If for any reason you wish to rollback to the previous version, you can make use of the <a href="commands/fabric-container-rollback.html">fabric:container-rollback</a> command.</p>
<pre><code>    fabric:container-rollback 1.1 mycontainer
</code></pre><p>That doesn&#39;t look like rolling, does it. You are strongly recommended to test your changes on a single container, before applying the changes to the whole cluster. Applying an upgrade to all containers can be achieved using the <strong>--all</strong> option as demonstrated below.</p>
<pre><code>      fabric:container-upgrade --all 1.1 mycontainer
</code></pre><h4 id="complete-walk-through">Complete walk through</h4>
<p>The following clip demonstrates most of the profile concepts &amp; features described so far. It uses a small Fabric cluster of 5 containers on EC2, plus 1 Fabric registry.
It describe how to modify profiles and explains how to perform single and rolling container upgrades.</p>
<object width="853" height="480"><param name="movie" value="http://www.youtube.com/v/-2W5NwC2oAo?version=3&amp;hl=en_US&amp;rel=0"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/-2W5NwC2oAo?version=3&amp;hl=en_US&amp;rel=0" type="application/x-shockwave-flash" width="853" height="480" allowscriptaccess="always" allowfullscreen="true"></embed></object>

<h4 id="importing-and-exporting-profiles">Importing and exporting profiles</h4>
<p>There are cases where you have put quite a lot of effort in creating the profiles that much your needs and you want to store them somewhere.
A good example is when you move from the development environment to the staging or the production environment. You simply just don&#39;t want to go over the process of creating the profiles again.
For such cases Fabric allows you export your profiles in text and also import them back. So you can safely store them or even import them to a version control system.</p>
<p>To export the Fabric profiles you can use the <a href="commands/fabric-export.html">fabric:export</a></p>
<pre><code>     fabric:export
</code></pre><p>This command will export the whole registry to files. The default export location is the fabric/export folder under the karaf home directory. To change the default location you just need to specify the path as an argument:</p>
<pre><code>     fabric:export /path/to/my/export/location
</code></pre><p>Of course the registry also contains runtime information which may be unneeded. You can choose initial znode from which the export will occur. For example to just keep the configuration data:</p>
<pre><code>     fabric:export -p /fabric/configs /path/to/my/export/location
</code></pre><p>You also have the option to include or exclude part of the registry using regular expression.</p>
<p>In a similar way the import operation works. Please keep in mind that by default when creating a Fabric the <a href="commands/fabric-create.html">fabric:create</a> command will import everything it finds in fabric/import under the karaf home folder.</p>
<pre><code>    fabric:create
</code></pre><p>to specify an other folder for importing to the registry you can simply use the <strong>--import-dir</strong> option. For example:</p>
<pre><code>    fabric:create --import-dir /path/to/my/import/location
</code></pre><p>Of course there are cases where you need to import data to the registry after the registry has been created. You can use the the <a href="commands/fabric-export.html">fabric:export</a> as described below:</p>
<pre><code>    fabric:import
</code></pre><p>All the arguments and options of the <a href="commands/fabric-export.html">fabric:export</a> are also available to the <a href="commands/fabric-import.html">fabric:import</a> command.</p>
<p>For example if you exported the registry starting from the /fabric/configs/ znode and want to import them back starting from the same znode <em>(this is what makes sense, when exporting starting from a specific znode to import back starting from the same)</em>:</p>
<pre><code>  fabric:import -p /fabric/configs /path/to/my/import/location
</code></pre>
                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="./registry.html" class="navigation navigation-prev " aria-label="Previous page: Registry"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./agent.html" class="navigation navigation-next " aria-label="Next page: Agent"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="gitbook/app.js"></script>
        

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
